---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import WhatsAppButton from '../components/WhatsAppButton.astro';
import TestEpigeneticoTabs from '../components/TestEpigeneticoTabs';
---

<Layout title="Test Epigenético - LEV">
  <Header />
  <main>
    <!-- Hero Section -->
    <section class="relative min-h-[80vh] flex items-center pt-32 pb-16 bg-gradient-to-b from-primary to-primary/90">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-20 w-full">
        <div class="grid grid-cols-1 lg:grid-cols-[1.4fr_1fr] gap-12 items-center">
          <!-- Texto a la izquierda -->
          <div class="text-center lg:text-left">
            <h1 class="text-4xl sm:text-5xl lg:text-6xl font-serif text-white mb-6 leading-tight">
              Test Epigenético
            </h1>
            <p class="text-lg sm:text-xl lg:text-xl font-sans text-white/90 mb-6 leading-relaxed">
              Conoce con exactitud cómo tus hábitos diarios están influyendo en tu salud a través del análisis epigenético más completo del mercado.
            </p>
            <div class="space-y-4 text-base sm:text-lg font-sans text-white/80 leading-relaxed mb-8">
              <p>
                En LEV, creemos que tu ADN no es tu destino. El test epigenético nos permite analizar cómo factores como tu alimentación, ejercicio, niveles de estrés, exposición ambiental y estilo de vida están activando o desactivando genes sin cambiar tu código genético.
              </p>
            </div>
            
            <!-- Beneficios -->
            <div class="mt-8">
              <h3 class="text-xl sm:text-2xl font-serif text-white mb-6 text-center lg:text-left">
                Este tratamiento es para ti si buscas los siguientes beneficios:
              </h3>
              <div class="flex flex-wrap gap-3 justify-center lg:justify-start">
                <div class="bg-white/10 backdrop-blur-sm border border-white/30 rounded-full px-6 py-2.5 font-sans text-sm font-medium text-white">
                  Conocerte mejor
                </div>
                <div class="bg-white/10 backdrop-blur-sm border border-white/30 rounded-full px-6 py-2.5 font-sans text-sm font-medium text-white">
                  Transformarte
                </div>
                <div class="bg-white/10 backdrop-blur-sm border border-white/30 rounded-full px-6 py-2.5 font-sans text-sm font-medium text-white">
                  Escuchar tu cuerpo
                </div>
              </div>
            </div>
          </div>

          <!-- Formulario a la derecha -->
          <div id="agendar-cita" class="bg-white rounded-3xl p-8 lg:p-10 shadow-2xl max-w-lg w-full mx-auto lg:mx-0 border border-neutral-light/50 scroll-mt-24">
            <div class="mb-6">
              <h2 class="text-2xl lg:text-3xl font-serif text-primary mb-3 leading-tight">Agenda tu cita</h2>
              <div class="w-16 h-1 bg-primary/20 rounded-full mb-3"></div>
              <p class="text-sm lg:text-base font-sans text-primary/70 leading-relaxed mb-4">
                Completa el formulario y nos pondremos en contacto contigo
              </p>
              
              <!-- Beneficios sutiles -->
              <div class="space-y-2 mb-4">
                <div class="flex items-center gap-2">
                  <svg class="w-4 h-4 text-secondary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <p class="text-xs font-sans text-primary/70">
                    Consulta y diagnóstico personalizado
                  </p>
                </div>
                <div class="flex items-center gap-2">
                  <svg class="w-4 h-4 text-secondary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <p class="text-xs font-sans text-primary/70">
                    Análisis de 96 biomarcadores epigenéticos
                  </p>
                </div>
              </div>
            </div>
            
            <form class="space-y-5">
              <div>
                <label for="nombre" class="block text-sm font-sans font-semibold text-primary mb-2 tracking-wide">
                  Nombre y apellidos
                </label>
                <input
                  type="text"
                  id="nombre"
                  name="nombre"
                  class="w-full px-4 py-3 border-2 border-primary/20 rounded-xl focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 text-primary font-sans transition-all duration-300 bg-neutral/30 placeholder:text-primary/40"
                  placeholder="Tu nombre completo"
                />
              </div>
              
              <div>
                <label for="telefono" class="block text-sm font-sans font-semibold text-primary mb-2 tracking-wide">
                  Número de teléfono
                </label>
                <input
                  type="tel"
                  id="telefono"
                  name="telefono"
                  class="w-full px-4 py-3 border-2 border-primary/20 rounded-xl focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 text-primary font-sans transition-all duration-300 bg-neutral/30 placeholder:text-primary/40"
                  placeholder="+51 999 999 999"
                />
              </div>
              
              <div>
                <label for="email" class="block text-sm font-sans font-semibold text-primary mb-2 tracking-wide">
                  Correo electrónico
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="w-full px-4 py-3 border-2 border-primary/20 rounded-xl focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 text-primary font-sans transition-all duration-300 bg-neutral/30 placeholder:text-primary/40"
                  placeholder="tu@email.com"
                />
              </div>
              
              <div class="pt-1">
                <button
                  type="submit"
                  class="w-full px-8 py-4 bg-primary text-white hover:bg-primary/90 transition-all duration-300 font-sans text-base font-semibold rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1 active:translate-y-0"
                >
                  Agendar cita
                </button>
              </div>
              
              <div class="flex items-center justify-center gap-2 pt-1">
                <svg class="w-4 h-4 text-primary/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                <p class="text-xs font-sans text-primary/60">
                  Rápido y sin esperas: nosotras te llamamos
                </p>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- Sección con Toggle Buttons -->
    <TestEpigeneticoTabs client:load />

    <!-- CTA Section -->
    <section id="cta-section" class="relative py-16 lg:py-24 bg-primary overflow-hidden">
      <!-- Imágenes de fondo animadas - Primera fila -->
      <div class="absolute top-0 left-0 right-0 overflow-hidden pointer-events-none cta-row-1">
        <div class="cta-background-images flex gap-8 items-start pt-6 md:pt-8">
          <img 
            src="/fonts/hero-image-1.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/hero-image-2.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-test-epigenetico.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-programa-nutricional-uno.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-programa-nutricional-dos.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <!-- Duplicar para loop continuo -->
          <img 
            src="/fonts/hero-image-1.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/hero-image-2.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-test-epigenetico.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-programa-nutricional-uno.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-programa-nutricional-dos.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
        </div>
      </div>

      <!-- Imágenes de fondo animadas - Segunda fila -->
      <div class="absolute bottom-0 left-0 right-0 overflow-hidden pointer-events-none cta-row-2">
        <div class="cta-background-images-2 flex gap-8 pb-6 md:pb-8">
          <img 
            src="/fonts/servicio-programa-nutricional-dos.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-programa-nutricional-uno.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-test-epigenetico.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/hero-image-2.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/hero-image-1.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <!-- Duplicar para loop continuo -->
          <img 
            src="/fonts/servicio-programa-nutricional-dos.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-programa-nutricional-uno.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/servicio-test-epigenetico.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/hero-image-2.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
          <img 
            src="/fonts/hero-image-1.png" 
            alt="" 
            class="cta-bg-image h-[150px] md:h-[180px] lg:h-[200px] w-auto object-cover rounded-lg opacity-20"
          />
        </div>
      </div>
      
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="max-w-4xl mx-auto text-center">
          <h2 class="cta-title text-4xl sm:text-5xl lg:text-6xl font-serif text-white mb-6">
            ¿Listo para conocer tu estado epigenético?
          </h2>
          <p class="cta-subtitle text-lg sm:text-xl font-sans text-white/90 mb-8 max-w-2xl mx-auto leading-relaxed">
            Agenda tu cita y descubre cómo optimizar tu salud con un enfoque personalizado basado en ciencia.
          </p>
          <div class="cta-button flex flex-col sm:flex-row gap-4 justify-center">
            <a 
              href="#agendar-cita" 
              class="px-8 py-4 bg-white text-primary hover:bg-neutral-light transition-all duration-300 font-sans text-lg font-medium rounded-full shadow-lg hover:shadow-xl"
            >
              Agendar cita
            </a>
            <a 
              href="/" 
              class="px-8 py-4 border-2 border-white text-white hover:bg-white hover:text-primary transition-all duration-300 font-sans text-lg font-medium rounded-full"
            >
              Volver al inicio
            </a>
          </div>
        </div>
      </div>
    </section>
  </main>
  <Footer />
  <WhatsAppButton />
</Layout>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';
  
  gsap.registerPlugin(ScrollTrigger);
  
  function initCtaAnimations() {
    const ctaSection = document.querySelector('#cta-section');
    if (!ctaSection) return;

    // Animación de entrada para CTA
    gsap.fromTo('.cta-title', 
      { opacity: 0, y: 30 },
      {
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '#cta-section',
          start: 'top 80%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    gsap.fromTo('.cta-subtitle', 
      { opacity: 0, y: 20 },
      {
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out',
        delay: 0.2,
        scrollTrigger: {
          trigger: '#cta-section',
          start: 'top 80%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    gsap.fromTo('.cta-button', 
      { opacity: 0, y: 20 },
      {
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out',
        delay: 0.4,
        scrollTrigger: {
          trigger: '#cta-section',
          start: 'top 80%',
          toggleActions: 'play none none reverse'
        }
      }
    );
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCtaAnimations);
  } else {
    initCtaAnimations();
  }

  // Animación de imágenes de fondo
  function initCtaBackgroundAnimation() {
    const backgroundImages = document.querySelector('.cta-background-images');
    const backgroundImages2 = document.querySelector('.cta-background-images-2');
    
    if (backgroundImages) {
      const totalWidth = backgroundImages.scrollWidth;
      const halfWidth = totalWidth / 2;

      gsap.to('.cta-background-images', {
        x: -halfWidth,
        duration: 60,
        ease: 'none',
        repeat: -1,
      });
    }

    if (backgroundImages2) {
      const totalWidth2 = backgroundImages2.scrollWidth;
      const halfWidth2 = totalWidth2 / 2;

      gsap.to('.cta-background-images-2', {
        x: -halfWidth2,
        duration: 65,
        ease: 'none',
        repeat: -1,
      });
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCtaBackgroundAnimation);
  } else {
    initCtaBackgroundAnimation();
  }
</script>

<style>
  .cta-background-images,
  .cta-background-images-2 {
    will-change: transform;
    display: flex;
    gap: 2rem;
  }
  
  .cta-bg-image {
    flex-shrink: 0;
    filter: blur(2px);
    width: auto;
    object-fit: cover;
  }
  
  @media (min-width: 768px) and (max-width: 1023px) {
    .cta-row-1 {
      top: 0;
      height: auto;
    }
    
    .cta-row-2 {
      height: auto;
    }
    
    .cta-bg-image {
      opacity: 0.15;
      height: 140px;
    }
  }
</style>

